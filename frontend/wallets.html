<!DOCTYPE html>
<html>

<head>
    <title>Connected Wallets</title>
</head>

<body>
    <h1>Connected Wallets History</h1>

    <table border="1" cellpadding="10">
        <thead>
            <tr>
                <th>Wallet Address</th>
                <th>Date</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="walletTable"></tbody>
    </table>

    <!-- Modal Dialog -->
    <div id="walletModal" style="display: none;">
        <div>
            <h2>Wallet Details</h2>
            <p><b>Wallet Address:</b> <span id="walletAddress"></span></p>
            <p><b>Date:</b> <span id="walletDate"></span></p>
            <p><b>Time:</b> <span id="walletTime"></span></p>
            <button id="modifyBtn">Modify</button>
            <button id="deleteBtn">Delete</button>
            <button id="closeModalBtn">Close</button>
        </div>
    </div>



    <script>
        const list = JSON.parse(localStorage.getItem("walletHistory") || "[]");
        const table = document.getElementById("walletTable");

        table.innerHTML = '';

        list.forEach(entry => {
            table.innerHTML += `
                <tr>
                    <td>${entry.address}</td>
                    <td>${entry.date}</td>
                    <td>${entry.time}</td>
                </tr>
            `;
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const list = JSON.parse(localStorage.getItem("walletHistory") || "[]");
            const table = document.getElementById("walletTable");

            // Populate the table with wallets
            list.forEach((entry, index) => {
                const row = table.insertRow();
                row.dataset.index = index; // Store the index for reference

                row.innerHTML = `
            <td>${entry.address}</td>
            <td>${entry.date}</td>
            <td>${entry.time}</td>
        `;

                row.addEventListener("click", function () {
                    // Open the modal and display wallet details
                    const wallet = list[this.dataset.index];
                    document.getElementById("walletAddress").innerText = wallet.address;
                    document.getElementById("walletDate").innerText = wallet.date;
                    document.getElementById("walletTime").innerText = wallet.time;
                    document.getElementById("walletModal").style.display = "block";
                });
            });

            // Close the modal
            document.getElementById("closeModalBtn").addEventListener("click", function () {
                document.getElementById("walletModal").style.display = "none";
            });

            // Delete the wallet
            document.getElementById("deleteBtn").addEventListener("click", function () {
                const walletAddress = document.getElementById("walletAddress").innerText;
                let list = JSON.parse(localStorage.getItem("walletHistory") || "[]");

                list = list.filter(entry => entry.address !== walletAddress);
                localStorage.setItem("walletHistory", JSON.stringify(list));

                // Remove the wallet from the table
                const row = Array.from(table.rows).find(r => r.cells[0].innerText === walletAddress);
                if (row) {
                    row.remove();
                }

                // Close the modal
                document.getElementById("walletModal").style.display = "none";
            });

            // Modify button (if needed in future)
            document.getElementById("modifyBtn").addEventListener("click", function () {
                alert("Modify functionality not implemented yet.");
            });
        });

    </script>
</body>

</html>